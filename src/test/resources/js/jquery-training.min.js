$(function(){function d(f){$("#messageDialog").dialog("open");$("#messageDialog .msg").html(f)}function a(){var f=$("#personsTable").jqGrid("getGridParam","selrow");if(f){$.ajax({type:"Get",url:"/jquery-training/person?operation=getPersonByName&name="+f,dataType:"json",cache:false,success:function(g){if(g){$("#personName").html(g.name);$("#personSex").html(g.sex);$("#personAge").html(g.age);$("#personStation").html(g.station);$("#personDetailDialog").dialog("open")}},error:function(g){d("获取人员详细信息错误!")}})}else{d("请选择要查看的人员！")}}function c(){var f=$("#personsTable").jqGrid("getGridParam","selrow");if(f){$.ajax({type:"Get",url:"/jquery-training/person?operation=deletePerson&name="+f,dataType:"json",cache:false,success:function(g){if(g){$("#personsTable").jqGrid("delRowData",f)}},error:function(g){d("删除人员信息错误!")}})}else{d("请选择要删除的人员！")}}function e(){$.ajax({type:"Get",url:"/jquery-training/person?operation=getPersons",dataType:"json",cache:false,success:function(f){if(f&&f.length>0){$("#personsTable").jqGrid("clearGridData");$.each(f,function(g,h){$("#personsTable").jqGrid("addRowData",h.name,{name:h.name,sex:h.sex,age:h.age,station:h.station,},"first")})}},error:function(f){d("获取所有人员信息错误!")}})}function b(){var g=$("#username").val();var f=$("#password").val();if(!g){d("请输入登录用户名!");return}if(!f){d("请输入登录密码!");return}$.ajax({type:"Get",url:"/jquery-training/login?username="+g+"&password="+f,dataType:"json",cache:false,success:function(h){if(h){$("#loginDialog").dialog("close");$("#messageDialog").dialog("close");$("#personsTable").jqGrid("setGridWidth","960");$("#welcomeContent").css("display","block")}else{d("登录失败!请输入正确的用户名和密码!")}},error:function(h){d("登录错误!")}})}$("#getPersonsButton").click(function(){e();return false});$("#deletePersonButton").click(function(){c();return false});$("#showDetailButton").click(function(){a();return false});$("#loginDialog").dialog({title:"登录框",autoOpen:false,width:300,modal:true,resizable:false,closeOnEscape:false,buttons:[{id:"loginButton",text:"登录",click:function(){b();return false}},{id:"cancelLoginButton",text:"取消",click:function(){$("#loginDialog").dialog("close");return false}}]});$("#loginDialog").keydown(function(f){if(f.keyCode==13){b()}});$("#loginDialog").dialog("open");$("#messageDialog").dialog({title:"信息框",autoOpen:false,width:300,modal:true,resizable:false,buttons:{"确定":function(){$("#messageDialog").dialog("close");return false}}});$("#personsTable").jqGrid({height:"320",datatype:"json",colNames:["姓名","性别","年龄","岗位"],colModel:[{name:"name",index:"name",width:"100",sortable:false},{name:"sex",index:"sex",width:"100",sortable:false},{name:"age",index:"age",width:"100",sortable:false},{name:"station",index:"station",width:"100",sortable:false}],caption:"人员列表",viewrecords:true,cellEdit:false,loadtext:"数据加载中...",rowNum:15,autowidth:true,sortname:"name",forceFit:true,altRows:true,multiselect:false,ondblClickRow:function(){a()}});$("#personDetailDialog").dialog({title:"详细信息框",autoOpen:false,width:280,height:320,modal:true,resizable:false,buttons:{"确定":function(){$("#personDetailDialog").dialog("close");return false}}})});